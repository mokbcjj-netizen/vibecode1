<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ë‰´ìŠ¤ í—¤ë“œë¼ì¸ í€´ì¦ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f9ff;
            touch-action: manipulation;
            user-select: none;
        }
        .card-enter {
            animation: slideIn 0.3s ease-out forwards;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        
        .modal-pop {
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        /* íƒ€ì´ë¨¸ ë°” ì• ë‹ˆë©”ì´ì…˜ */
        .timer-bar {
            transition: width 0.1s linear;
        }
    </style>
</head>
<body class="bg-slate-100 h-screen flex flex-col items-center justify-center overflow-hidden relative">

    <!-- ë°°ê²½ ì¥ì‹ -->
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden -z-10 opacity-20 pointer-events-none">
        <div class="absolute top-10 left-10 text-6xl">ğŸ“°</div>
        <div class="absolute bottom-20 right-10 text-6xl">ğŸ“º</div>
        <div class="absolute top-1/2 left-1/4 text-4xl">ğŸ™ï¸</div>
        <div class="absolute bottom-10 left-1/3 text-5xl">ğŸ“¡</div>
    </div>

    <!-- ê²Œì„ ì»¨í…Œì´ë„ˆ -->
    <div id="game-container" class="w-full max-w-md bg-white rounded-3xl shadow-2xl overflow-hidden flex flex-col h-[85vh] md:h-[700px] relative border-4 border-slate-200">
        
        <!-- ìƒë‹¨ í—¤ë” -->
        <div class="bg-slate-800 text-white p-4 flex justify-between items-center z-10">
            <div class="flex items-center space-x-2">
                <span class="text-xl">ğŸ“º</span>
                <span class="font-bold text-lg">AI ë‰´ìŠ¤ íŒ©íŠ¸ì²´í¬</span>
                <span class="text-xs bg-slate-600 px-2 py-1 rounded ml-2" id="round-indicator">1/10</span>
            </div>
            <div class="font-mono text-xl font-bold text-yellow-400">
                <span id="score-display">0</span> ì 
            </div>
        </div>
        
        <!-- íƒ€ì´ë¨¸ ë°” (ìƒë‹¨) -->
        <div class="w-full h-2 bg-slate-200">
            <div id="timer-bar" class="h-full bg-red-500 w-full timer-bar"></div>
        </div>

        <!-- ì „ì²´ ì§„í–‰ë„ ë°” (í•˜ë‹¨) -->
        <div class="w-full bg-slate-200 h-1">
            <div id="progress-bar" class="bg-blue-500 h-1 transition-all duration-300 w-0"></div>
        </div>

        <!-- ë©”ì¸ ê²Œì„ ì˜ì—­ -->
        <div class="flex-1 flex flex-col items-center justify-center p-6 relative bg-slate-50">
            
            <!-- ì‹œì‘ í™”ë©´ -->
            <div id="start-screen" class="absolute inset-0 bg-white z-20 flex flex-col items-center justify-center text-center p-6 space-y-6">
                <div class="text-6xl mb-4 animate-bounce">ğŸ“¢</div>
                <h1 class="text-3xl font-black text-slate-800 leading-tight">AI ë‰´ìŠ¤<br>ê¸ì • vs ë¶€ì •</h1>
                <p class="text-slate-500 break-keep">ì œì‹œë˜ëŠ” <strong>ë‰´ìŠ¤ í—¤ë“œë¼ì¸</strong>ì„ ë³´ê³ <br>ìš°ë¦¬ ì‚¬íšŒì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì´<br><span class="text-blue-600 font-bold">ê¸ì •ì (ê¸°íšŒ)</span>ì¸ì§€ <span class="text-red-500 font-bold">ë¶€ì •ì (ìœ„ê¸°)</span>ì¸ì§€<br>íŒë‹¨í•´ë³´ì„¸ìš”!</p>
                <div class="bg-slate-50 p-4 rounded-xl text-sm text-slate-600 w-full max-w-xs">
                    <p>â±ï¸ ê¸°ì‚¬ë‹¹ <strong>15ì´ˆ</strong> ì œí•œ</p>
                    <p>ğŸ‘‚ ì†Œë¦¬ë¥¼ ì¼œê³  í”Œë ˆì´í•˜ì„¸ìš”</p>
                </div>
                <button onclick="startGame()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-2xl text-xl shadow-lg transform transition hover:scale-105 active:scale-95 w-full max-w-xs">
                    ë‰´ìŠ¤ ë³´ê¸° ì‹œì‘! ğŸ“º
                </button>
            </div>

            <!-- ê²°ê³¼ í™”ë©´ -->
            <div id="result-screen" class="hidden absolute inset-0 bg-white z-20 flex flex-col items-center justify-center text-center p-6 space-y-6">
                <div class="text-6xl mb-2">ğŸ“°</div>
                <h2 class="text-3xl font-black text-slate-800">ë³´ë„ ì¢…ë£Œ!</h2>
                <div class="bg-slate-100 p-6 rounded-2xl w-full">
                    <p class="text-slate-500 mb-2">ìµœì¢… ì ìˆ˜</p>
                    <p class="text-5xl font-black text-blue-600" id="final-score">0</p>
                    <p class="text-sm text-slate-400 mt-2" id="final-message">ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤!</p>
                </div>
                <button onclick="startGame()" class="px-8 py-4 bg-green-500 hover:bg-green-600 text-white font-bold rounded-2xl text-xl shadow-lg transform transition hover:scale-105 active:scale-95 w-full max-w-xs">
                    ë‹¤ì‹œ ì‹œì‘í•˜ê¸° ğŸ”„
                </button>
            </div>

            <!-- ì¹´ë“œ ì˜ì—­ -->
            <div id="card-area" class="w-full flex-1 flex items-center justify-center relative perspective-1000 my-4">
                <div id="current-card" class="w-full bg-white border border-slate-200 rounded-sm shadow-xl flex flex-col items-center overflow-hidden transform transition-all duration-300 relative">
                    <!-- ë‰´ìŠ¤ í—¤ë” ìŠ¤íƒ€ì¼ -->
                    <div class="w-full bg-red-600 text-white text-xs font-bold px-4 py-1 flex justify-between items-center">
                        <span>BREAKING NEWS</span>
                        <span class="font-normal opacity-80">LIVE â—</span>
                    </div>
                    
                    <div class="p-6 flex flex-col items-center justify-center text-center space-y-4 flex-1 w-full">
                        <div id="card-icon" class="text-6xl mb-2">ğŸ’Š</div>
                        <!-- ë‰´ìŠ¤ í—¤ë“œë¼ì¸ -->
                        <div class="w-full border-t-2 border-b-2 border-slate-800 py-4 my-2">
                            <div id="card-text" class="text-xl md:text-2xl font-black text-slate-900 leading-snug break-keep font-serif">
                                AI, ì‹ ì•½ í›„ë³´ ë¬¼ì§ˆ 3ì¼ ë§Œì— ë°œê²¬... ì˜ë£Œê³„ 'í˜ëª…'
                            </div>
                        </div>
                        <div class="text-xs text-slate-400 flex items-center gap-1">
                            <span>K-AI News</span> | <span>ê¸°ì: ì¸ê³µì§€ëŠ¥</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="time-warning" class="text-red-500 font-bold text-sm h-6 opacity-0 transition-opacity">âš ï¸ ë§ˆê° ì‹œê°„ì´ ì„ë°•í–ˆìŠµë‹ˆë‹¤!</div>

        </div>

        <!-- ì»¨íŠ¸ë¡¤ ë²„íŠ¼ -->
        <div id="controls" class="p-4 grid grid-cols-2 gap-3 bg-white border-t border-slate-200 relative z-10 hidden shadow-[0_-5px_15px_rgba(0,0,0,0.05)]">
            <button onclick="handleAnswer('positive')" class="group flex flex-col items-center justify-center py-4 bg-blue-50 border-2 border-blue-200 rounded-xl hover:bg-blue-100 hover:border-blue-400 active:bg-blue-200 transition-all hover:-translate-y-1">
                <span class="text-2xl mb-1 group-hover:scale-110 transition-transform">ğŸ‘ ê¸ì •ì  ì˜í–¥</span>
                <span class="text-xs font-bold text-blue-600">ìƒí™œì˜ í¸ì˜ / í˜ì‹  / ì•ˆì „</span>
            </button>
            <button onclick="handleAnswer('negative')" class="group flex flex-col items-center justify-center py-4 bg-red-50 border-2 border-red-200 rounded-xl hover:bg-red-100 hover:border-red-400 active:bg-red-200 transition-all hover:-translate-y-1">
                <span class="text-2xl mb-1 group-hover:scale-110 transition-transform">ğŸ‘ ë¶€ì •ì  ì˜í–¥</span>
                <span class="text-xs font-bold text-red-600">ìœ¤ë¦¬ ë¬¸ì œ / ì¼ìë¦¬ / ë²”ì£„</span>
            </button>
        </div>
    </div>

    <!-- í•´ì„¤ íŒì—… -->
    <div id="explanation-modal" class="hidden fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl p-6 w-full max-w-sm modal-pop shadow-2xl text-center border-t-8 border-slate-800">
            <div class="flex justify-center -mt-10 mb-2">
                <div id="modal-icon-bg" class="bg-white rounded-full p-2 shadow-lg">
                    <div id="modal-icon" class="text-4xl">âœ…</div>
                </div>
            </div>
            
            <h3 id="modal-title" class="text-xl font-black mb-2">ì •ë‹µì…ë‹ˆë‹¤!</h3>
            
            <div class="bg-slate-50 p-4 rounded-xl text-left mb-6 border border-slate-100">
                <span id="modal-type-badge" class="inline-block px-2 py-0.5 rounded text-xs font-bold text-white mb-2 bg-blue-500">ê¸ì •ì  ì˜í–¥</span>
                <p id="modal-desc" class="text-slate-700 text-sm leading-relaxed break-keep">
                    ì„¤ëª… ë‚´ìš©ì´ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤.
                </p>
            </div>
            
            <button onclick="nextCard()" class="w-full bg-slate-800 text-white font-bold py-3.5 rounded-xl hover:bg-slate-700 transition transform active:scale-95 flex items-center justify-center gap-2">
                ë‹¤ìŒ ê¸°ì‚¬ ë³´ê¸° <span class="text-lg">ğŸ‘‰</span>
            </button>
        </div>
    </div>

    <script>
        // ë‰´ìŠ¤ í—¤ë“œë¼ì¸ ë°ì´í„°
        const gameData = [
            { 
                text: "[ì†ë³´] AI, ì‹ ì•½ í›„ë³´ ë¬¼ì§ˆ 3ì¼ ë§Œì— ë°œê²¬... ì˜ë£Œê³„ 'í˜ëª…'", 
                type: "positive", 
                icon: "ğŸ’Š", 
                desc: "ìˆ˜ë…„ì´ ê±¸ë¦¬ë˜ ì‹ ì•½ ê°œë°œ ê³¼ì •ì„ AIê°€ íšê¸°ì ìœ¼ë¡œ ë‹¨ì¶•í•˜ì—¬ í¬ê·€ë³‘ ì¹˜ë£Œì˜ ê°€ëŠ¥ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤." 
            },
            { 
                text: "ìœ ëª… ì•µì»¤ ì–¼êµ´ í•©ì„±í•œ 'ê°€ì§œ ë‰´ìŠ¤' ì˜ìƒ... ì‹œë¯¼ë“¤ ëŒ€í˜¼ë€", 
                type: "negative", 
                icon: "ğŸ‘º", 
                desc: "ë”¥í˜ì´í¬(Deepfake) ê¸°ìˆ ë¡œ ë§Œë“  ê°€ì§œ ì˜ìƒì´ ì‚¬ì‹¤ì²˜ëŸ¼ í¼ì ¸ ì‚¬íšŒì  ì‹ ë¢°ë¥¼ ë¬´ë„ˆëœ¨ë¦¬ê³  ìˆìŠµë‹ˆë‹¤." 
            },
            { 
                text: "AI ë²ˆì—­ ì•ˆê²½ ì“°ê³  í•´ì™¸ì—¬í–‰... 'ì–¸ì–´ ì¥ë²½ ì™„ì „íˆ ë¬´ë„ˆì¡Œë‹¤'", 
                type: "positive", 
                icon: "ğŸ˜", 
                desc: "ì„œë¡œ ë‹¤ë¥¸ ì–¸ì–´ë¥¼ ì¨ë„ ì‹¤ì‹œê°„ìœ¼ë¡œ í†µì—­ë˜ì–´ ììœ ë¡œìš´ ì†Œí†µê³¼ ë¬¸í™” êµë¥˜ê°€ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤." 
            },
            { 
                text: "ì±„ìš© AI, ì—¬ì„± ì§€ì›ì ì ìˆ˜ ë‚®ê²Œ í‰ê°€... 'ì•Œê³ ë¦¬ì¦˜ ì°¨ë³„' ë…¼ë€", 
                type: "negative", 
                icon: "ğŸ“‰", 
                desc: "ê³¼ê±°ì˜ í¸í–¥ëœ ë°ì´í„°ë¥¼ í•™ìŠµí•œ AIê°€ ì±„ìš© ê³¼ì •ì—ì„œ ì„±ë³„ì— ë”°ë¥¸ ë¶ˆê³µì •í•œ ê²°ê³¼ë¥¼ ì´ˆë˜í–ˆìŠµë‹ˆë‹¤." 
            },
            { 
                text: "ìŠ¤ë§ˆíŠ¸ CCTV, ê¸¸ê°€ì— ì“°ëŸ¬ì§„ ì‹œë¯¼ í¬ì°©í•´ 'ê³¨ë“ íƒ€ì„' ì§€ì¼°ë‹¤", 
                type: "positive", 
                icon: "ğŸš¨", 
                desc: "AIê°€ ìœ„í—˜ ìƒí™©ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ê³  ì¦‰ì‹œ êµ¬ì¡°ëŒ€ì— ì•Œë ¤ ì†Œì¤‘í•œ ìƒëª…ì„ êµ¬í–ˆìŠµë‹ˆë‹¤." 
            },
            { 
                text: "ì›¹íˆ° ì‘ê°€ë“¤ 'AIê°€ ë‚´ ê·¸ë¦¼ì²´ ë¬´ë‹¨ ë„ìš©'... ì§‘ë‹¨ ì†Œì†¡ ì˜ˆê³ ", 
                type: "negative", 
                icon: "ğŸ¨", 
                desc: "ì°½ì‘ìì˜ ë™ì˜ ì—†ì´ ì‘í’ˆì„ í•™ìŠµí•œ AIê°€ ìœ ì‚¬í•œ ê·¸ë¦¼ì„ ê·¸ë ¤ë‚´ì–´ ì €ì‘ê¶Œ ì¹¨í•´ ë…¼ë€ì´ ì¼ê³  ìˆìŠµë‹ˆë‹¤." 
            },
            { 
                text: "ë³µì¡í•œ ì—°ë§ì •ì‚°, AI ë¹„ì„œê°€ ì„œë¥˜ ë¶„ì„í•´ 1ë¶„ ë§Œì— 'ëšë”±'", 
                type: "positive", 
                icon: "ğŸ§¾", 
                desc: "ë³µì¡í•˜ê³  ë²ˆê±°ë¡œìš´ í–‰ì •/ì„¸ë¬´ ì—…ë¬´ë¥¼ AIê°€ ë¹ ë¥´ê³  ì •í™•í•˜ê²Œ ì²˜ë¦¬í•´ì£¼ì–´ ìƒí™œì´ í¸ë¦¬í•´ì¡ŒìŠµë‹ˆë‹¤." 
            },
            { 
                text: "ë³´ì´ìŠ¤í”¼ì‹±, ì´ì œ ë”¸ ëª©ì†Œë¦¬ê¹Œì§€ AIë¡œ í‰ë‚´... í”¼í•´ ì†ì¶œ", 
                type: "negative", 
                icon: "ğŸ“", 
                desc: "AI ìŒì„± í•©ì„± ê¸°ìˆ ì´ ë²”ì£„ì— ì•…ìš©ë˜ì–´ ì‹¤ì œ ê°€ì¡±ì¸ ì²™ ì†ì´ëŠ” ê¸ˆìœµ ì‚¬ê¸°ê°€ ì§€ëŠ¥í™”ë˜ê³  ìˆìŠµë‹ˆë‹¤." 
            },
            { 
                text: "AIê°€ ì‚°ë¶ˆ í™•ì‚° ê²½ë¡œ ì˜ˆì¸¡... ì¸ê·¼ ë§ˆì„ ì£¼ë¯¼ 500ëª… ë¯¸ë¦¬ ëŒ€í”¼", 
                type: "positive", 
                icon: "ğŸ”¥", 
                desc: "ë¹…ë°ì´í„° ë¶„ì„ì„ í†µí•´ ì¬ë‚œ ê²½ë¡œë¥¼ ë¯¸ë¦¬ ì˜ˆì¸¡í•˜ê³  ëŒ€ì‘í•˜ì—¬ ëŒ€ê·œëª¨ ì¸ëª… í”¼í•´ë¥¼ ë§‰ì•˜ìŠµë‹ˆë‹¤." 
            },
            { 
                text: "ê³¼ì œ ëŒ€ì‹  ì¨ì£¼ëŠ” AI... êµìœ¡ í˜„ì¥ 'í•™ìƒë“¤ ì‚¬ê³ ë ¥ ì €í•˜' ìš°ë ¤", 
                type: "negative", 
                icon: "ğŸ¤”", 
                desc: "ìŠ¤ìŠ¤ë¡œ ê³ ë¯¼í•˜ì§€ ì•Šê³  AIì—ê²Œ ë‹µì„ êµ¬í•˜ëŠ” ìŠµê´€ì´ ì¸ê°„ ê³ ìœ ì˜ ë¹„íŒì  ì‚¬ê³  ëŠ¥ë ¥ì„ ë–¨ì–´ëœ¨ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤." 
            }
        ];

        let currentRound = 0;
        let score = 0;
        let shuffledData = [];
        const totalRounds = 10;
        
        // íƒ€ì´ë¨¸ ê´€ë ¨ ë³€ìˆ˜ (ê¸°ì‚¬ê°€ ê¸¸ì–´ì¡Œìœ¼ë‹ˆ 15ì´ˆë¡œ ì—°ì¥)
        let timerInterval;
        let timeLeft = 15;
        const maxTime = 15;

        // DOM ìš”ì†Œ
        const startScreen = document.getElementById('start-screen');
        const resultScreen = document.getElementById('result-screen');
        const controls = document.getElementById('controls');
        const currentCard = document.getElementById('current-card');
        const cardText = document.getElementById('card-text');
        const cardIcon = document.getElementById('card-icon');
        const progressBar = document.getElementById('progress-bar');
        const scoreDisplay = document.getElementById('score-display');
        const roundIndicator = document.getElementById('round-indicator');
        const timerBar = document.getElementById('timer-bar');
        const timeWarning = document.getElementById('time-warning');
        
        // ëª¨ë‹¬ ìš”ì†Œ
        const modal = document.getElementById('explanation-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalDesc = document.getElementById('modal-desc');
        const modalIcon = document.getElementById('modal-icon');
        const modalTypeBadge = document.getElementById('modal-type-badge');

        // ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ (Web Audio API)
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new AudioContext();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        function playTone(type) {
            initAudio();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            const now = audioCtx.currentTime;

            if (type === 'correct') {
                // ë‰´ìŠ¤ ì‹œê·¸ë„ ëŠë‚Œ (ì†”-ë„!)
                osc.type = 'square';
                osc.frequency.setValueAtTime(392.00, now); // G4
                osc.frequency.setValueAtTime(523.25, now + 0.1); // C5
                
                gainNode.gain.setValueAtTime(0.05, now);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.4);
                
                osc.start(now);
                osc.stop(now + 0.4);
            } else if (type === 'wrong') {
                // ë - (ë‚®ì€ í†¤)
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, now);
                osc.frequency.linearRampToValueAtTime(100, now + 0.3);
                
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.linearRampToValueAtTime(0.01, now + 0.3);
                
                osc.start(now);
                osc.stop(now + 0.3);
            }
        }

        // ê²Œì„ ì‹œì‘
        function startGame() {
            initAudio();
            score = 0;
            currentRound = 0;
            scoreDisplay.innerText = score;
            startScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            controls.classList.remove('hidden');
            
            shuffledData = [...gameData].sort(() => Math.random() - 0.5).slice(0, totalRounds);
            
            updateUI();
            startTimer();
            showCard();
        }

        // íƒ€ì´ë¨¸ ì‹œì‘
        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = maxTime;
            updateTimerBar();
            timeWarning.style.opacity = '0';
            
            timerInterval = setInterval(() => {
                timeLeft -= 0.1;
                updateTimerBar();
                
                // 5ì´ˆ ë‚¨ì•˜ì„ ë•Œ ê²½ê³ 
                if (timeLeft <= 5 && timeLeft > 0) {
                    timeWarning.style.opacity = '1';
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    handleAnswer('timeout');
                }
            }, 100);
        }

        function updateTimerBar() {
            const percentage = (timeLeft / maxTime) * 100;
            timerBar.style.width = `${Math.max(0, percentage)}%`;
            
            if (percentage > 50) timerBar.className = "h-full w-full timer-bar bg-green-500";
            else if (percentage > 20) timerBar.className = "h-full w-full timer-bar bg-yellow-400";
            else timerBar.className = "h-full w-full timer-bar bg-red-600";
        }

        function showCard() {
            const data = shuffledData[currentRound];
            cardText.innerText = data.text;
            cardIcon.innerText = data.icon;
            
            // ì¹´ë“œ ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ ë° ìŠ¤íƒ€ì¼ ë¦¬ì…‹
            currentCard.classList.remove('shake');
            currentCard.classList.add('card-enter');
            // ì• ë‹ˆë©”ì´ì…˜ ì¬ì‹¤í–‰ì„ ìœ„í•œ ë¦¬í”Œë¡œìš°
            void currentCard.offsetWidth; 
        }

        function handleAnswer(userChoice) {
            clearInterval(timerInterval); 
            const data = shuffledData[currentRound];
            let isCorrect = false;

            if (userChoice === 'timeout') {
                isCorrect = false;
            } else {
                isCorrect = userChoice === data.type;
            }
            
            if (isCorrect) {
                score += 10;
                scoreDisplay.innerText = score;
                playTone('correct');
                
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#2563eb', '#3b82f6', '#60a5fa'] // Blue themes
                });

                showModal(true, data);
            } else {
                playTone('wrong');
                currentCard.classList.remove('card-enter');
                currentCard.classList.add('shake');
                showModal(false, data, userChoice === 'timeout');
            }
        }

        function showModal(isCorrect, data, isTimeout = false) {
            modal.classList.remove('hidden');
            
            if (isCorrect) {
                modalTitle.innerText = "ì •ë‹µì…ë‹ˆë‹¤!";
                modalTitle.className = "text-xl font-black mb-2 text-green-600";
                modalIcon.innerText = "â­•";
            } else {
                if (isTimeout) {
                    modalTitle.innerText = "ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤!";
                } else {
                    modalTitle.innerText = "ì˜¤ë‹µì…ë‹ˆë‹¤!";
                }
                modalTitle.className = "text-xl font-black mb-2 text-red-600";
                modalIcon.innerText = "âŒ";
            }
            
            // ë±ƒì§€ ì„¤ì •
            if (data.type === 'positive') {
                modalTypeBadge.innerText = "ê¸ì •ì  ì˜í–¥ (ê¸°íšŒ)";
                modalTypeBadge.className = "inline-block px-2 py-1 rounded text-xs font-bold text-white mb-2 bg-blue-500";
            } else {
                modalTypeBadge.innerText = "ë¶€ì •ì  ì˜í–¥ (ìœ„ê¸°)";
                modalTypeBadge.className = "inline-block px-2 py-1 rounded text-xs font-bold text-white mb-2 bg-red-500";
            }

            modalDesc.innerHTML = data.desc;
        }

        function nextCard() {
            modal.classList.add('hidden');
            currentRound++;
            updateUI();

            if (currentRound < shuffledData.length) {
                // ê¸°ì¡´ ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ì œê±° í›„ ë‹¤ì‹œ showCard
                currentCard.classList.remove('card-enter');
                setTimeout(() => {
                    showCard();
                    startTimer();
                }, 50);
            } else {
                endGame();
            }
        }

        function endGame() {
            controls.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
            
            const msg = document.getElementById('final-message');
            if(score === 100) {
                msg.innerText = "ëª¨ë“  ë‰´ìŠ¤ë¥¼ ì •í™•íˆ íŒŒì•…í•˜ì…¨êµ°ìš”! í›Œë¥­í•©ë‹ˆë‹¤! ğŸ†";
                confetti({
                    particleCount: 300,
                    spread: 120,
                    origin: { y: 0.6 }
                });
            }
            else if(score >= 70) msg.innerText = "AIì˜ ì˜í–¥ì— ëŒ€í•´ ì˜ ì´í•´í•˜ê³  ê³„ì‹œë„¤ìš”! ğŸ‘";
            else msg.innerText = "ë‰´ìŠ¤ íŒ©íŠ¸ì²´í¬ê°€ ì¡°ê¸ˆ ë” í•„ìš”í•´ ë³´ì…ë‹ˆë‹¤! ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš” ğŸ’ª";
        }

        function updateUI() {
            const percentage = ((currentRound) / totalRounds) * 100;
            progressBar.style.width = `${percentage}%`;
            roundIndicator.innerText = `${Math.min(currentRound + 1, totalRounds)}/${totalRounds}`;
        }
    </script>
</body>
</html>
